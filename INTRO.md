[TOC]

# 公交路线查询移动应用系统- QPython WebApp版本

搜索关键字：
-----

- QPython
- WebApp
- html5
- Web前端框架



概述
-----
在移动互联网应用开发的大潮中，有那么一种技术一直都在以主角的身份不断吸引诸多开发者的关注，它就是WebApp技术，和原生开发相比，WebApp能够快速兼容Web开发模式，快速上手，部署更新简单的优势得到了非常多的开发者的青睐。

QPython的WebApp方案就是众多WebApp方案中的极为优秀的一种，QPython 的 WEB APP 方案有以下优势：

- 强大的本地逻辑处理解析器：Python 脚本解析器
QPython 有一个强大的本地逻辑处理解析器，能在你的手机端进行进（线）程运算、图形处理及渲染、进行多种协议的网络通讯等工作，这样不需要提交给云端就能充分地利用了手机处理能力。

- 海量的库支持，更快实现
Python 世界中积累了多年的大部分的类库都能够被快速引入到 QPython 体系中，因此您可以不必重复造轮子。

- 最小的开发环境要求
进行 QPython 开发，您只需要有一台安卓手机即可。当然您也可以在 PC 端完成开发，再将程序上传到 QPython 上；现在QPython已经推出了一个QWE(QPython Web Editor)工具，更能让你只需要通过一个浏览器就可以连接你的手机进行开发。



项目“公交线路查询”简介
---
设计一个“公交线路查询”的QPython WebApp应用，主要以html作为UI，使用Python来调用Android系统的接口。
该应用有两个应用界面，一个用以收集用户输入的关键词（如需要查询的公交线路、始发地、目的地等），然后传递到另外一个应用界面里，让这个应用界面去以此作为参数去请求爱帮公交查询API，并将返回的JSON格式数据处理后展现到界面上。


公交线路查询功能，如图1-1所示。



换乘查询功能，如图1-2所示。



案例设计与实现
---------

### 需求分析

#### 项目实现的功能:

实现“公交路线查询”和“换乘查询”功能。这两个功能的实现方法实则上是大同小异的。爱帮公交提供给了开发者公交“线路查询”和“换乘查询”的API，我们只需将用户输入的关键词作为参数去请求对应API，即可取得用户所期望的数据，再将这些数据解析并展现到界面。故不涉及复杂的算法问题和本地数据库操作。

主界面中能自动定位用户的所在城市，即自动帮助用户判断所在的城市，并自动为用户填充“城市名”输入框。实现方法为获取当前联网用户的外网IP，通过请求百度IP定位API得到用户的城市名。

可以用Python开发的模式创建一个Web工程，工程目录结构如图1-3所示


#### 界面设计

由于本次项目使用QPython WebApp作为主要框架，所以只需创建一个主布局文件，并添加一个填充父元素的WebView控件，每个Activity都加载这个布局文件，再将html页面加载到WebView控件中。本项目的html页面较为简单，故无需使用专门的IDE去编写代码，可直接选用自己所喜好的文本编辑器即可。主布局文件代码如图1-4所示

